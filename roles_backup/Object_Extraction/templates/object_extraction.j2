=========================================
FMC OBJECT/OBJECT-GROUP EXTRACTION REPORT
=========================================
Report ID: {{ execution_id }}
Generated: {{ report_date }} at {{ report_time }}
Host: {{ inventory_hostname }} ({{ ansible_host }})
=========================================

EXECUTIVE SUMMARY
-----------------
Total Objects Extracted: {{ total_objects | default(0) }}

Object Type Distribution:
- Network Objects: {{ extraction_results | selectattr('object_type','equalto','Network Object') | list | length }}
- Network Groups:  {{ extraction_results | selectattr('object_type','equalto','Network Group')  | list | length }}
- Port Objects:    {{ extraction_results | selectattr('object_type','equalto','Port Object')    | list | length }}
- Port Groups:     {{ extraction_results | selectattr('object_type','equalto','Port Group')     | list | length }}
- URL Objects:     {{ extraction_results | selectattr('object_type','equalto','URL Object')     | list | length }}
- URL Groups:      {{ extraction_results | selectattr('object_type','equalto','URL Group')      | list | length }}
- Geolocations:    {{ extraction_results | selectattr('object_type','equalto','Geolocation')    | list | length }}

=========================================

DETAILED OBJECT LISTING
-----------------------
{% for obj_type in ['Network Object','Network Group','Port Object','Port Group','URL Object','URL Group','Geolocation'] %}
{% set items = extraction_results | selectattr('object_type','equalto',obj_type) | list %}
{% if items|length > 0 %}

{{ obj_type | upper }}S ({{ items|length }})
{{ '-' * (obj_type | length + 10) }}
{% for obj in items %}
{{ loop.index }}. {{ obj.name | default('') }}
   - Type: {{ obj.kind | default('') }}
   - UUID: {{ obj.id | default('') }}
   - Value: {{ obj.value | default(obj.port | default(obj.url | default(obj.name | default('')))) }}
   {% set member_objs = (obj.objects | default([]) | map(attribute='name') | list) %}
   {% set literal_vals = [] %}
   {% for lit in obj.literals | default([]) %}
   {%   set _ = literal_vals.append(lit.value | default(lit.port | default(lit.url | default(lit | to_json)))) %}
   {% endfor %}
   {% if (member_objs|length + literal_vals|length) > 0 %}
   - Members: {{ (member_objs + literal_vals) | join('; ') }}
   {% endif %}
   {% if obj.description is defined and obj.description %}
   - Description: {{ obj.description }}
   {% endif %}

{% endfor %}
{% endif %}
{% endfor %}

=========================================
EXTRACTION STATISTICS
=========================================
- Execution Status: {{ execution_status | upper }}
- Extraction Time: {{ report_date }} {{ report_time }}
- Total Objects Processed: {{ total_objects | default(0) }}

FILES GENERATED
---------------
- JSON Export: objects_{{ execution_id }}.json
- CSV Export: objects_{{ execution_id }}.csv
- This Report: object_report_{{ execution_id }}.txt

=========================================
End of Report - Generated by AAP
=========================================